{% extends "base-extended" %}

{% block extendedtitle %}Archive{% endblock %}

{% block altcontent %}
<div class="darkbox" id="blogtoc">
	<h1>Table of Contents</h1>
	<ul>
		{% for post in latest %}
			<li><a href="#post{{post.id}}">{{post.title}}</a></li>
		{% endfor %}
	</ul>

	{% if date_list %}
		<h1>Blog Archive</h1>

		<ul>
		{% for year in date_list %}
			<li><a href="/archive/{{ year.year }}/">{{year.year}}</a></li>
		{% endfor %}
		</ul>
	{% endif %}

</div>

{% endblock %}

{% load comments %}

{% block content %}

{% for post in latest %}

	{% get_free_comment_count for blog.posts post.id as comment_count %}

	<a name="post{{post.id}}"></a>
	<div class="blogentry {% if not post.released %}unreleased{% endif %}">
		<div class="date">{{post.post_date}}</div>
		<div class="title"><a href="/post/{{post.post_date|date:"Y/M/d"|lower}}/{{post.slug}}/">{{post.title}}</a></div>
		{{ post.contents }}
		<p class="postmeta">
			<a href="/post/{{post.post_date|date:"Y/M/d"|lower}}/{{post.slug}}/">
			{{ comment_count }} comment{{ comment_count|pluralize }}
			</a>
		</p>
	</div>
{% endfor %}

{% endblock %}
